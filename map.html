<!DOCTYPE html>
<html>
<head>
  <title>Simple Map</title>
  <meta name="viewport" content="initial-scale=1.0">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="icon" sizes="192x192" href="/icon.png">
  <link rel="manifest" href="manifest.json">
  <style>
      /* Always set the map height explicitly to define the size of the div
      * element that contains the map. */
      #map {
        height: 100%;
        width: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 95%;
        margin: 0.5%;
        padding: 0;
        background: grey;
      }
      .button {
        margin-top: 20;
      }
      #loader {
        position: absolute;
        left: 50%;
        top: 50%;
        z-index: 1;
        width: 150px;
        height: 150px;
        margin: -75px 0 0 -75px;
        border: 16px solid #f3f3f3;
        border-radius: 50%;
        border-top: 16px solid #3498db;
        -webkit-animation: spin 2s linear infinite;
        animation: spin 2s linear infinite;
      }

      @-webkit-keyframes spin {
        0% { -webkit-transform: rotate(0deg); }
        100% { -webkit-transform: rotate(360deg); }
      }

      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      /* Add animation to "page content" */
      .animate-bottom {
        position: relative;
        -webkit-animation-name: animatebottom;
        -webkit-animation-duration: 1s;
        animation-name: animatebottom;
        animation-duration: 1s
      }

      @-webkit-keyframes animatebottom {
        from { bottom:-100px; opacity:0 } 
        to { bottom:0px; opacity:1 }
      }

      @keyframes animatebottom { 
        from{ bottom:-100px; opacity:0 } 
        to{ bottom:0; opacity:1 }
      }

    </style>
  </head>
  <body onload="myFunction()" style="margin:0;">

   <div id="loader"></div> 
   <div id="map" draggable="true" onmousedown="start(event)" onmouseup="pan(event)" ontouchstart="start(event)" ontouchend="pan(event)"></div>
   <button type="button" class="button" onCLick="zoomIn()">+</button>
   <button type="button" class="button" onCLick="zoomOut()">-</button>
   <script>
    var map;
    function initMap() {
      map = new google.maps.Map(document.getElementById('map'), {
        center: {lat: 59.3498092, lng: 18.0684758},
        zoom: 15,
        mapTypeId: 'satellite',
        heading: 90,
        tilt: 45,
        zoomControl: false,
        draggable: false,
        disableDefaultUI: true
      });

      marker = new google.maps.Marker({
        map: map,
        draggable: true,
        animation: google.maps.Animation.DROP,
        position: {lat: 59.3498092, lng: 18.0684758}
      });
      marker.addListener('click', toggleBounce);

      google.maps.event.addListener(map, 'click', function(event) {
        addMarker(event.latLng, map);
      });
    }

    function zoomIn() {
      map.setZoom(map.zoom + 1)
    }

    function zoomOut() {
      map.setZoom(map.zoom - 1)
    }

    var x_start;
    var y_start;

    function start(event) {
      x_start = event.clientX;
      y_start = event.clientY;
    }


    function pan(event) {
      console.log("slut");
      var xpos = x_start - event.clientX;
      var ypos = y_start - event.clientY;
      map.panBy(xpos, ypos);
    }

    function addMarker(location, map) {
      var marker = new google.maps.Marker({
        position: location,
        map: map,
        animation: google.maps.Animation.DROP,
      });
      marker.addListener('click', toggleBounce);
    }


    function toggleBounce() {
      if (marker.getAnimation() !== null) {
        marker.setAnimation(null);
      } else {
        marker.setAnimation(google.maps.Animation.BOUNCE);
      }
    }


    function myFunction() {
      myVar = setTimeout(showPage, 1000);
    }

    function showPage() {
      document.getElementById("loader").style.display = "none";
      document.getElementById("map").style.display = "block";
    }


  </script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyANJSROmnM72JZN35SRpGfFFTx7P4feqic&callback=initMap"></script>
</body>
</html>